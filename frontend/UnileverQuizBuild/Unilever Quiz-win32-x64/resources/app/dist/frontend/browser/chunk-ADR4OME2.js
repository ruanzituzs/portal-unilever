import{a as K}from"./chunk-QMFBIE3V.js";import{a as N,b as Q,c as g,d as F,e as G,f as T,g as j,h as L,i as D,j as O,k as B,l as H,m as P,n as $,o as R,p as U}from"./chunk-BDL2EWQC.js";import{a as J}from"./chunk-PMGH5KPS.js";import{$a as w,Ab as A,Ba as d,Ia as S,Ma as q,Qa as x,T as b,U as _,V as m,W as p,Xa as c,Ya as e,Za as i,_a as o,a as C,ab as v,b as z,bb as f,db as M,eb as a,fb as y,gb as E,yb as V,zb as I}from"./chunk-G2JQ2GAW.js";function W(s,u){if(s&1&&(e(0,"option",39),a(1),i()),s&2){let t=u.$implicit;c("value",t.id),d(),y(t.title)}}function X(s,u){if(s&1){let t=w();e(0,"div",51)(1,"label",52),o(2,"input",53),e(3,"div",54),m(),e(4,"svg",55),o(5,"path",56),i()()(),p(),o(6,"input",57),e(7,"button",58),v("click",function(){let r=b(t).index,l=f().index,h=f();return _(h.removeAnswer(l,r))}),m(),e(8,"svg",29),o(9,"path",59),i()()()}if(s&2){let t,n,r,l=u.$implicit,h=u.index;M("bg-green-500/10",(t=l.get("isCorrect"))==null?null:t.value)("border-green-500/30",(n=l.get("isCorrect"))==null?null:n.value)("border",(r=l.get("isCorrect"))==null?null:r.value),c("formGroupName",h)}}function Y(s,u){if(s&1){let t=w();e(0,"div",40)(1,"div",41)(2,"span",42),a(3),i(),e(4,"button",43),v("click",function(){let r=b(t).index,l=f();return _(l.removeQuestion(r))}),m(),e(5,"svg",29),o(6,"path",44),i()()(),p(),e(7,"div",45),o(8,"input",46),i(),e(9,"div",47)(10,"div",48),a(11,"Op\xE7\xF5es de resposta"),i(),x(12,X,10,7,"div",49),e(13,"button",50),v("click",function(){let r=b(t).index,l=f();return _(l.addAnswer(r))}),m(),e(14,"svg",29),o(15,"path",30),i(),a(16," Adicionar Op\xE7\xE3o "),i()()()}if(s&2){let t=u.index,n=f();c("formGroupName",t),d(3),E("Pergunta ",t+1),d(9),c("ngForOf",n.getAnswers(t).controls)}}function Z(s,u){if(s&1){let t=w();e(0,"div",60),m(),e(1,"svg",61),o(2,"path",62),i(),p(),e(3,"p",63),a(4,"Nenhuma pergunta adicionada ainda"),i(),e(5,"button",64),v("click",function(){b(t);let r=f();return _(r.addQuestion())}),m(),e(6,"svg",65),o(7,"path",30),i(),a(8," Adicionar Primeira Pergunta "),i()()}}function ee(s,u){s&1&&(m(),e(0,"svg",65),o(1,"path",66),i())}function te(s,u){s&1&&(m(),e(0,"svg",67),o(1,"circle",68)(2,"path",69),i())}var me=(()=>{class s{fb;quizzesService;videosService;quizForm;videos=[];creating=!1;constructor(t,n,r){this.fb=t,this.quizzesService=n,this.videosService=r,this.quizForm=this.fb.group({title:["",g.required],description:[""],videoId:[""],minScore:[70,[g.required,g.min(0),g.max(100)]],questions:this.fb.array([])})}ngOnInit(){this.videosService.getVideos().subscribe(t=>{this.videos=t}),this.addQuestion()}get questions(){return this.quizForm.get("questions")}getAnswers(t){return this.questions.at(t).get("answers")}addQuestion(){let t=this.fb.group({text:["",g.required],answers:this.fb.array([])});this.questions.push(t),this.addAnswer(this.questions.length-1),this.addAnswer(this.questions.length-1)}removeQuestion(t){this.questions.removeAt(t)}addAnswer(t){let n=this.fb.group({text:[""],isCorrect:[!1]});this.getAnswers(t).push(n)}removeAnswer(t,n){this.getAnswers(t).removeAt(n)}generateAiQuestions(){let t=this.quizForm.get("videoId")?.value;t&&(this.creating=!0,this.quizzesService.generateAiQuiz(t).subscribe({next:n=>{this.creating=!1,this.questions.clear(),n.forEach(r=>{let l=this.fb.group({text:[r.text,g.required],answers:this.fb.array([])}),h=l.get("answers");r.answers.forEach(k=>{h.push(this.fb.group({text:[k.text,g.required],isCorrect:[k.isCorrect]}))}),this.questions.push(l)}),alert("Perguntas geradas com sucesso pela IA!")},error:n=>{this.creating=!1,console.error(n),alert("Erro ao gerar perguntas com IA.")}}))}onSubmit(){if(this.quizForm.valid){this.creating=!0;let t=this.quizForm.value,n=z(C({},t),{videoId:t.videoId?t.videoId:void 0,minScore:Number(t.minScore)});console.log("Submitting cleaned quiz data:",n),this.quizzesService.createQuiz(n).subscribe({next:()=>{this.creating=!1,alert("Quiz criado com sucesso!"),this.quizForm.reset(),this.questions.clear(),this.addQuestion()},error:r=>{this.creating=!1,console.error("Erro ao criar quiz:",r),alert("Erro ao criar quiz. Verifique os dados e tente novamente.")}})}else alert("Preencha todo o formul\xE1rio corretamente.")}static \u0275fac=function(n){return new(n||s)(S(R),S(J),S(K))};static \u0275cmp=q({type:s,selectors:[["app-quiz-manager"]],decls:62,vars:9,consts:[[1,"p-8","max-w-4xl","mx-auto","animate-fade-in"],[1,"flex","items-center","gap-4","mb-8"],["src","/logo.png","alt","Unilever Logo",1,"h-10","w-auto","border-r","pr-4","border-slate-300"],["routerLink","/admin",1,"p-2","rounded-lg","hover:bg-slate-100","transition-colors"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"text-2xl","font-bold","text-slate-800"],[1,"text-gray-500","text-sm","mt-1"],[1,"glass-card","p-8","space-y-8",3,"ngSubmit","formGroup"],[1,"text-lg","font-semibold","text-slate-800","mb-4","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"grid","grid-cols-1","gap-6","md:grid-cols-2"],[1,"col-span-2"],[1,"form-label"],["formControlName","title","type","text","placeholder","Ex: Quiz de Seguran\xE7a do Trabalho",1,"form-control"],["formControlName","description","rows","2","placeholder","Descreva o objetivo deste quiz...",1,"form-control"],["formControlName","minScore","type","number","placeholder","70",1,"form-control"],["formControlName","videoId",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"text-xs","text-gray-400","mt-1"],[1,"border-gray-700"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-lg","font-semibold","text-slate-800","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-purple-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"badge","badge-primary","ml-2"],["type","button",1,"btn","btn-ghost","text-sm",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["formArrayName","questions",1,"space-y-6"],["class","card relative group",3,"formGroupName",4,"ngFor","ngForOf"],["class","text-center py-12 border-2 border-dashed border-gray-700 rounded-xl",4,"ngIf"],[1,"flex","justify-end","gap-4","pt-6","border-t","border-gray-700"],["routerLink","/admin",1,"btn","btn-ghost"],["type","submit",1,"btn","btn-primary","px-8",3,"disabled"],["class","w-5 h-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","animate-spin w-5 h-5","fill","none","viewBox","0 0 24 24",4,"ngIf"],[3,"value"],[1,"card","relative","group",3,"formGroupName"],[1,"flex","items-center","justify-between","mb-4"],[1,"badge","badge-primary"],["type","button",1,"p-2","rounded-lg","text-gray-500","hover:text-red-400","hover:bg-red-500/10","transition-colors","opacity-0","group-hover:opacity-100",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"mb-4"],["formControlName","text","type","text","placeholder","Digite a pergunta...",1,"form-control","text-lg","font-medium"],["formArrayName","answers",1,"pl-4","border-l-2","border-blue-500/30","space-y-3"],[1,"text-xs","text-gray-500","uppercase","tracking-wide","mb-2"],["class","flex items-center gap-3 p-3 rounded-lg bg-[#0f172a]/50 group/answer transition-colors",3,"formGroupName","bg-green-500/10","border-green-500/30","border",4,"ngFor","ngForOf"],["type","button",1,"text-sm","text-blue-400","hover:text-blue-300","flex","items-center","gap-1","mt-2","transition-colors",3,"click"],[1,"flex","items-center","gap-3","p-3","rounded-lg","bg-[#0f172a]/50","group/answer","transition-colors",3,"formGroupName"],[1,"relative","cursor-pointer"],["type","checkbox","formControlName","isCorrect",1,"sr-only","peer"],[1,"w-6","h-6","rounded-full","border-2","border-gray-600","flex","items-center","justify-center","peer-checked:border-green-500","peer-checked:bg-green-500","transition-colors"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-white","opacity-0","peer-checked:opacity-100"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M5 13l4 4L19 7"],["formControlName","text","type","text","placeholder","Digite uma resposta...",1,"flex-1","bg-transparent","border-none","text-slate-800","placeholder-gray-400","focus:outline-none","focus:ring-0","text-sm"],["type","button",1,"p-1.5","rounded","text-gray-500","hover:text-red-400","hover:bg-red-500/10","transition-colors","opacity-0","group-hover/answer:opacity-100",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"text-center","py-12","border-2","border-dashed","border-gray-700","rounded-xl"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","text-gray-600","mx-auto","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","1.5","d","M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-gray-500","mb-4"],["type","button",1,"btn","btn-primary",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","w-5","h-5"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(n,r){n&1&&(e(0,"div",0)(1,"div",1),o(2,"img",2),e(3,"a",3),m(),e(4,"svg",4),o(5,"path",5),i()(),p(),e(6,"div")(7,"h2",6),a(8,"Criar Novo Quiz"),i(),e(9,"p",7),a(10,"Adicione perguntas e respostas para o novo quiz"),i()()(),e(11,"form",8),v("ngSubmit",function(){return r.onSubmit()}),e(12,"div")(13,"h3",9),m(),e(14,"svg",10),o(15,"path",11),i(),a(16," Informa\xE7\xF5es B\xE1sicas "),i(),p(),e(17,"div",12)(18,"div",13)(19,"label",14),a(20,"T\xEDtulo do Quiz"),i(),o(21,"input",15),i(),e(22,"div",13)(23,"label",14),a(24,"Descri\xE7\xE3o"),i(),o(25,"textarea",16),i(),e(26,"div")(27,"label",14),a(28,"Pontua\xE7\xE3o M\xEDnima (%)"),i(),o(29,"input",17),i(),e(30,"div",13)(31,"label",14),a(32,"V\xEDdeo de Treinamento (Opcional)"),i(),e(33,"select",18)(34,"option",19),a(35,"Selecione um v\xEDdeo..."),i(),x(36,W,2,2,"option",20),i(),e(37,"p",21),a(38,"Se selecionado, o funcion\xE1rio precisar\xE1 assistir ao v\xEDdeo antes de iniciar o quiz."),i()()()(),o(39,"hr",22),e(40,"div")(41,"div",23)(42,"h3",24),m(),e(43,"svg",25),o(44,"path",26),i(),a(45," Perguntas "),p(),e(46,"span",27),a(47),i()(),e(48,"button",28),v("click",function(){return r.addQuestion()}),m(),e(49,"svg",29),o(50,"path",30),i(),a(51," Adicionar Pergunta "),i()(),p(),e(52,"div",31),x(53,Y,17,3,"div",32),i(),x(54,Z,9,0,"div",33),i(),e(55,"div",34)(56,"a",35),a(57,"Cancelar"),i(),e(58,"button",36),x(59,ee,2,0,"svg",37)(60,te,3,0,"svg",38),a(61),i()()()()),n&2&&(d(11),c("formGroup",r.quizForm),d(25),c("ngForOf",r.videos),d(11),y(r.questions.length),d(6),c("ngForOf",r.questions.controls),d(),c("ngIf",r.questions.length===0),d(4),c("disabled",!r.quizForm.valid||r.creating),d(),c("ngIf",!r.creating),d(),c("ngIf",r.creating),d(),E(" ",r.creating?"Salvando...":"Salvar Quiz"," "))},dependencies:[A,V,I,U,T,P,$,Q,j,N,H,F,G,B,O,L,D],encapsulation:2})}return s})();export{me as QuizManagerComponent};
